"use strict";(self.webpackChunkcloud_trade_sdk=self.webpackChunkcloud_trade_sdk||[]).push([[362],{61362:(e,t,n)=>{n.r(t),n.d(t,{default:()=>je});var o=n(52322),i=n(2724),r=n(21137),a=n(21627),s=n(19526),l=n(61750),c=n(60642),d=n(35635),u=n(98195),m=n(2784),p=n(20115),f=n(12720);function h(e,t){const n=new Date,o=n.setHours(24,0,0,0),i=`get${e}`;return{startTime:n[`set${e}`](n[i]()-t),endTime:o}}const y={"1d":{label:"1 Day",getTimes:()=>h("Date",1)},"1w":{label:"1 Week",getTimes:()=>h("Date",7)},"1m":{label:"1 Month",getTimes:()=>h("Month",1)},"3m":{label:"3 Months",getTimes:()=>h("Month",3)}};var g=n(49967),b=n(35102),x=n(62252);const v=e=>(0,x.ZK)("trd-tradeTransaction",e);var j=n(20512),w=n(42166);const O=({children:e})=>(0,o.jsx)(j.Z,Object.assign({variant:"caption",__css:{color:"t.third"}},{children:e}),void 0),T=e=>{var{color:t="t.primary"}=e,n=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}(e,["color"]);return(0,o.jsx)(j.Z,Object.assign({variant:"captionSub",color:t},n),void 0)},S=({children:e,sx:t})=>(0,o.jsx)(d.Z,Object.assign({className:"row-item",sx:t},{children:e}),void 0),Z=({symbol:e,time:t,balanceDelta:n,balancetype:o,showSymbolColumn:i},r,a)=>{const s=[{columnKey:"amount",text:"Amount",i18n:"amount",value:n},{columnKey:"type",text:"Type",i18n:"type",value:r(`bt-${o}`,{defaultValue:o})},{columnKey:"time",text:"Time",i18n:"time",value:(0,w.v)(new Date(t),"yyyy-MM-dd hh:mm:ss")}];return i?[...s,{columnKey:"symbol",text:"Symbol",i18n:"symbol",value:e?(0,f.t9)(e,a):"-"}]:s},C=m.memo((e=>{const{getI18n:t}=v(),{getI18n:n}=(0,x.yk)(),i=Z(e,t,n);return(0,o.jsxs)("div",Object.assign({className:"row-wrap"},{children:[(0,o.jsx)(S,Object.assign({sx:{pb:"10px !important"}},{children:e.asset}),void 0),i.map((({i18n:e,text:n,value:i,columnKey:r})=>(0,o.jsxs)(S,{children:[(0,o.jsx)(O,{children:t(e,{defaultValue:n})},void 0),(0,o.jsx)(T,{children:i},void 0)]},r)))]}),void 0)})),M=m.memo((e=>{const{getI18n:t}=v(),{getI18n:n}=(0,x.yk)(),i=Z(e,t,n);return(0,o.jsxs)("div",Object.assign({className:"row-wrap"},{children:[(0,o.jsx)(S,Object.assign({sx:{pb:"10px !important"}},{children:e.asset}),void 0),(0,o.jsx)("div",Object.assign({className:"row-grid"},{children:i.map((({i18n:e,text:n,value:i,columnKey:r})=>(0,o.jsxs)("div",Object.assign({className:r},{children:[(0,o.jsx)(O,{children:t(e,{defaultValue:n})},void 0),(0,o.jsx)(T,{children:i},void 0)]}),r)))}),void 0)]}),void 0)})),I={position:"relative",flexDirection:"column",flex:"1 0",".empty":{display:"flex",minHeight:120,alignItems:"center",justifyContent:"center",color:"t.secondary",fontSize:0},".row-wrap":{color:"t.primary",py:15,borderBottom:"1px solid",borderColor:"line","&:last-of-type":{mb:102,borderBottom:"none"},"& .row-item":{justifyContent:"space-between",alignItems:"center",py:"minor"}}},P={position:"relative",flexDirection:"column",height:"100%",".empty":{display:"flex",minHeight:120,alignItems:"center",justifyContent:"center",color:"t.secondary",fontSize:0},".row-list":{height:"calc(100% - 32px)",overflow:"auto","&::-webkit-scrollbar":{display:"none"},"&::-webkit-scrollbar-thumb":{bg:"transparent"}},".row-wrap":{color:"t.primary",py:15,borderBottom:"1px solid",borderColor:"line","&:last-of-type":{mb:15,borderBottom:"none"},".row-grid":{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"repeat(2, 1fr)",gridGap:"12px 16px",gridTemplateAreas:'"amount type"\n        "time symbol"',"& .type, & .symbol":{textAlign:"right"}},"& .row-item":{justifyContent:"space-between",alignItems:"center"}}};var R=n(52613),k=n(15836),E=n(89428),A=n(72779),W=n.n(A);const D={ml:"16px",width:["176px","auto","176px"],borderRight:"1px solid",borderRightColor:"newLine",".filter-placeholder":{display:"flex",alignItems:"center",color:"t.third",fontSize:"14px",".filter-label":{maxWidth:"155px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}},F={height:"312px",overflow:"auto",py:"4px",mt:"6px",bg:"modalBg",boxShadow:"elevation2",borderRadius:"4px",cursor:"pointer",".filter-option":{padding:"10px 16px",color:"t.primary","&:hover":{bg:"line"},"&.active":{color:"t.yellow"},fontSize:"14px"}},L=({balanceType:e,onFilterChange:t})=>{const{getI18n:n}=v();return(0,o.jsx)(R.Z,Object.assign({sx:D},{children:(0,o.jsx)(k.ZP,Object.assign({trigger:"hover",enablePortal:!0,overlay:(0,o.jsx)(R.Z,Object.assign({sx:F},{children:f.Wm.map((i=>(0,o.jsx)("div",Object.assign({className:W()({"filter-option":!0,active:i===e}),onClick:()=>{t(i)}},{children:"ALL"===i?n("ALL",{defaultValue:"All"}):n(`bt-${i}`,{defaultValue:i})}),i)))}),void 0)},{children:(0,o.jsxs)("div",Object.assign({className:"filter-placeholder"},{children:[(0,o.jsx)("div",Object.assign({className:"filter-label"},{children:"ALL"===e?n("ALL",{defaultValue:"All"}):n(`bt-${e}`,{defaultValue:e})}),void 0),(0,o.jsx)(E.Z,{ml:"4px",color:"t.third",size:16},void 0)]}),void 0)}),void 0)}),void 0)};var N=n(97103),_=n(78735);const B=({onReset:e,type:t,onSearch:n,balanceType:i,onFilterChange:r})=>{const{isMobile:a}=(0,x.Fs)();return a?(0,o.jsx)(_.Z,{onSearch:n,isTransaction:!0,onTransactionFilterChange:r},void 0):(0,o.jsx)(d.Z,Object.assign({sx:{alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",height:"32px"}},{children:(0,o.jsx)(N.Z,Object.assign({withReset:!0,onReset:e,type:t,onSearch:n},{children:(0,o.jsx)(L,{balanceType:i,onFilterChange:r},void 0)}),void 0)}),void 0)},V=()=>{const{getI18n:e}=v();return(0,o.jsx)("div",Object.assign({className:"empty"},{children:e("nodata",{defaultValue:"You have no trades."})}),void 0)},z=m.memo((({isMobile:e,isEmpty:t,hasMore:n,loadMore:i,showSymbolColumn:r,loading:a,data:s=[],filterType:l,balanceType:c,onFilterChange:u,onSearch:p,onReset:f})=>((0,m.useEffect)((()=>{n&&i()}),[n,i]),(0,o.jsxs)(d.Z,Object.assign({sx:e?I:P},{children:[(0,o.jsx)(g.Z,{fullScreen:!0,show:a},void 0),(0,o.jsx)(B,{onReset:f,type:l,onSearch:p,balanceType:c,onFilterChange:u},void 0),t?(0,o.jsx)(V,{},void 0):e?s.map((e=>(0,o.jsx)(C,Object.assign({},e,{showSymbolColumn:r}),e.tranId))):(0,o.jsx)("div",Object.assign({className:"row-list"},{children:s.map((e=>(0,o.jsx)(M,Object.assign({},e,{showSymbolColumn:r}),e.tranId)))}),void 0),n&&(0,o.jsx)(b.Z,{showMore:i,check:{offset:200},loading:a},void 0)]}),void 0))));var K=n(7688),H=n(18760),$=n(88133);const G=m.memo((({loading:e=!1,data:t,renderRow:n,empty:i,isEmpty:r,hasMore:a,loadMore:s,showSymbolColumn:l,rowHeight:c=80,minWidth:d=0,sx:u})=>{const f=(0,m.useRef)({data:t,flag:-1});f.current.data!==t&&(f.current.flag*=-1),f.current.data=t;const h=(0,m.useRef)(null),y=(0,p.tZ)(),b=(0,$.cp)(y);(0,m.useEffect)((()=>{if(!h.current)return;const{listRef:e}=h.current;if(!e||!e.current)return;const{current:t}=e;t.resetAfterIndex(0,!0)}),[f.current.flag]);const x=(0,m.useMemo)((()=>[{title:"",dataIndex:"",hideTitle:!0,render:(e,t)=>n(e,t,l)}]),[l,n]);return r?(0,o.jsx)(m.Fragment,{children:i},void 0):(0,o.jsxs)(R.Z,Object.assign({sx:Object.assign({position:"relative",".list-grid":{width:"100%","> div > div":{border:0,"> div":{my:0,px:0,height:"100%",borderBottom:"1px solid",borderBottomColor:"newLine"}}}},u)},{children:[(0,o.jsx)(g.Z,{fullScreen:!0,inner:!0,show:e},void 0),(0,o.jsx)(K.Z,{children:({height:e,width:n})=>(0,o.jsx)(H.Z,{style:{direction:b},threshold:5,hasMore:a,loadMore:s,className:"list-grid",columns:x,ref:h,data:t,listGridConfig:{collapseHeight:c,height:Math.max(e-4,0),width:Math.max(n,d)},__hackDataChanged:f.current.flag},void 0)},void 0)]}),void 0)}));var Q=n(45873);const U={my:0,py:"xs",width:"calc(100% - 5px)",display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,color:"t.primary",fontSize:[0],cursor:"auto"},Y={userSelect:"none",px:"xs",flexGrow:1,fontWeight:"normal",whiteSpace:"nowrap"},q={time:{minWidth:"120px"},type:{minWidth:"90px"},amount:{minWidth:"100px"},asset:{minWidth:"50px"},symbol:{minWidth:"125px"}},X=Object.keys(q).reduce(((e,t)=>e+parseInt(q[t].minWidth,10)),0),J=e=>{const t=q[e]||{};return Object.assign(Object.assign(Object.assign({},Y),t),{flexBasis:t.minWidth})},ee=m.memo((({time:e,balanceDelta:t,balancetype:n,asset:i,symbol:r,showSymbolColumn:a})=>{const{getI18n:s}=v(),{getI18n:l}=(0,x.yk)();return(0,o.jsxs)(d.Z,Object.assign({sx:Object.assign(Object.assign({},U),{color:"t.primary",fontSize:[0],cursor:"auto",py:0,width:"100%"})},{children:[(0,o.jsx)(j.Z,Object.assign({sx:Object.assign(Object.assign({},J("time")),{color:"table.timeColor"})},{children:(0,w.v)(new Date(e),"yyyy-MM-dd hh:mm:ss")}),void 0),(0,o.jsx)(j.Z,Object.assign({sx:J("type")},{children:s(`bt-${n}`,{defaultValue:n})}),void 0),(0,o.jsx)(j.Z,Object.assign({sx:J("amount")},{children:(0,Q.uf)(t,8)}),void 0),(0,o.jsx)(j.Z,Object.assign({sx:J("asset")},{children:i}),void 0),a?(0,o.jsx)(j.Z,Object.assign({sx:J("symbol")},{children:r?(0,f.t9)(r,l):"-"}),void 0):null]}),void 0)})),te=[{key:"time",text:"Time",i18n:"time"},{key:"type",text:"Type",i18n:"type"},{key:"amount",text:"Amount",i18n:"amount"},{key:"asset",text:"Asset",i18n:"asset"}],ne=[...te,{key:"symbol",text:"Symbol",i18n:"symbol"}],oe=(e,t,n)=>(0,o.jsx)(ee,Object.assign({},t,{showSymbolColumn:n}),void 0),ie=()=>{const{getI18n:e}=v();return(0,o.jsx)(R.Z,Object.assign({sx:{color:"t.secondary",textAlign:"center",fontSize:[0],marginTop:"xs"}},{children:e("nodata",{defaultValue:"You have no trades."})}),void 0)},re=m.forwardRef((({isEmpty:e,hasMore:t,loadMore:n,showSymbolColumn:i,loading:r,data:a=[]},s)=>{const{getI18n:l}=v(),c=(0,m.useMemo)((()=>(0,o.jsx)(d.Z,Object.assign({sx:Object.assign(Object.assign({},U),{borderBottom:"1px solid",borderBottomColor:"newLine"})},{children:(i?ne:te).map((e=>(0,o.jsx)(R.Z,Object.assign({sx:J(e.key)},{children:(0,o.jsx)(j.Z,Object.assign({sx:{fontSize:0,color:"t.third"}},{children:l(e.i18n,{defaultValue:e.text})}),void 0)}),e.key)))}),void 0)),[l,i]);return(0,o.jsxs)(d.Z,Object.assign({ref:s,sx:{flexDirection:"column",flex:"1 0",overflowX:"auto"}},{children:[c,(0,o.jsx)(G,{sx:{flex:"1 0"},loading:r,rowHeight:40,renderRow:oe,data:a,hasMore:t,loadMore:n,showSymbolColumn:i,isEmpty:e,empty:(0,o.jsx)(ie,{},void 0),minWidth:X},void 0)]}),void 0)})),ae=m.memo((({filterType:e,onReset:t,onSearch:n,balanceType:i,onFilterChange:r,hasMore:a,loadMore:s,showSymbolColumn:l,isEmpty:c,data:d,loading:u,currentPage:p})=>{const h=function(e){const t=(0,m.useRef)(null);return(0,m.useEffect)((()=>{if(e!==f.li)return;const{current:n}=t;if(n&&n instanceof Element){const e=n.querySelector(".list-grid");e&&(e.scrollTop=0)}})),t}(p);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(R.Z,{children:(0,o.jsx)(B,{onReset:t,type:e,onSearch:n,balanceType:i,onFilterChange:r},void 0)},void 0),(0,o.jsx)(re,{ref:h,hasMore:a,loadMore:s,showSymbolColumn:l,isEmpty:c,data:d,loading:u},void 0)]},void 0)}));var se=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))};const le=["TRANSFER","WITHDRAW","DEPOSIT"],ce=["COIN_SWAP_WITHDRAW","COIN_SWAP_DEPOSIT"],de="Init",ue="UpdateFilter",me="UpdateBalanceType",pe="FetchSuccess",fe={nextPage:f.li,hasMore:!0,balanceType:"ALL",filters:{timePeriod:f.Bs,startTime:0,endTime:0},items:[],symbolMap:{}},he=(0,r.j)({[de](e){const{symbolMap:t,items:n}=e;return Object.assign(Object.assign({},fe),{items:n,symbolMap:t})},[me](e,t){const{type:n}=t.payload;e.balanceType=n},[ue](e,t){const{startTime:n,endTime:o,timePeriod:i}=t.payload;void 0!==i&&(e.filters.timePeriod=i),void 0!==n&&(e.filters.startTime=n),void 0!==o&&(e.filters.endTime=o)},[pe](e,t){const{data:n,page:o}=t.payload;o===f.li?e.items=n:n.length&&(e.items=e.items.concat(n)),e.hasMore=n.length>0,e.nextPage=o+1}},fe),ye=(0,a.Z)(ue),ge=(0,a.Z)(me),be=(0,a.Z)(pe),xe=(0,a.Z)(de);const ve=()=>()=>Promise.resolve(),je=m.memo((({active:e=!1})=>{const t=(0,p.AM)(),[n,r]=(0,m.useReducer)(he,Object.assign(Object.assign({},fe),{symbolMap:t})),{nextPage:a,filters:h,hasMore:g}=n,{items:b=[],balanceType:x}=n;let v=(0,s.I9)(b);"TRANSFER"===x?v=b.filter((e=>-1!==le.indexOf(null==e?void 0:e.balancetype))):"COIN_SWAP"===x?v=b.filter((e=>-1!==ce.indexOf(null==e?void 0:e.balancetype))):x&&"ALL"!==x&&(v=b.filter((e=>(null==e?void 0:e.balancetype)===x)));const j="ALL"===x||v.some((e=>null==e?void 0:e.symbol)),{startTime:w,endTime:O}=function(e){let t=function(e){const t=y[e];return t?t.getTimes():null}(e.timePeriod);return t||(t={startTime:e.startTime,endTime:e.endTime}),t}(h),[T,S]=(0,m.useState)(ve),[{loading:Z},C]=(0,l.Z)((({page:e=f.li,times:t}={})=>se(void 0,void 0,void 0,(function*(){const{startTime:n,endTime:o}=t||{startTime:w,endTime:O};if(S(ve),null===n||null===o)return;const{data:i}=yield(({startTime:e,endTime:t,rows:n,page:o}={})=>se(void 0,void 0,void 0,(function*(){let i;try{i=yield(0,c.v_)("/bapi/futures/v1/private/future/user-data/transaction-history",{startTime:e,endTime:t-1,page:o,rows:n})}catch(e){throw new Error("nework error")}if("000000"!==i.code)throw new Error(i.message||"unknown error");return{data:i.data||[],total:i.total}})))({startTime:n,endTime:o,page:e,rows:f.n});r(be({data:i,page:e}))}))),[w,O],{loading:!0});(0,m.useEffect)((0,u.P)((()=>{S((()=>()=>C({page:a})))}),100),[C,a]);const M=(0,m.useCallback)((({type:e,startTime:t,endTime:n})=>{r(ye({timePeriod:e,startTime:t,endTime:n})),C({page:f.li,times:{startTime:t,endTime:n}})}),[C]),I=e=>r(ge({type:e})),P=()=>{r(xe()),M((0,s.OQ)("1d"))},R=!Z&&b.length<=0;return(0,m.useEffect)((()=>{e&&M((0,s.OQ)("1d"))}),[e]),(0,o.jsx)(d.Z,Object.assign({sx:{flexDirection:"column",height:"100%",pb:"xs",px:"sm"}},{children:(0,o.jsx)(i.Z,{children:({isMobile:e,isIPad:t})=>t?(0,o.jsx)(z,{isMobile:e,hasMore:g,loadMore:T,showSymbolColumn:j,isEmpty:R,data:v,loading:Z,filterType:h.timePeriod,balanceType:x,onFilterChange:I,onReset:P,onSearch:M},void 0):(0,o.jsx)(ae,{filterType:h.timePeriod,onSearch:M,balanceType:x,onFilterChange:I,onReset:P,hasMore:g,loadMore:T,showSymbolColumn:j,isEmpty:R,data:v,loading:Z,currentPage:a-1},void 0)},void 0)}),void 0)}))},21137:(e,t,n)=>{n.d(t,{j:()=>b});const o=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var o="function"!=typeof t[t.length-1]&&t.pop(),i=t;if(void 0===o)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var s=void 0===e,l=void 0===t;return s&&l&&o?o:i.reduce((function(e,n){return n.apply(void 0,[e,t].concat(r))}),s&&!l&&o?o:e)}};var i=n(47677),r=n.n(i);const a=function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},s=function(e){return"undefined"!=typeof Map&&e instanceof Map};function l(e){if(s(e))return Array.from(e.keys());if("undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys)return Reflect.ownKeys(e);var t=Object.getOwnPropertyNames(e);return"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t}var c="||";function d(e,t){return s(t)?t.get(e):t[e]}const u=(m=function(e){return(a(e)||s(e))&&(n=(t=l(e)).every((function(e){return"next"===e||"throw"===e})),!(t.length&&t.length<=2&&n));var t,n},function e(t,n,o,i){var r=void 0===n?{}:n,a=r.namespace,s=void 0===a?"/":a,u=r.prefix;return void 0===o&&(o={}),void 0===i&&(i=""),l(t).forEach((function(n){var r=function(e){return i||!u||u&&new RegExp("^"+u+s).test(e)?e:""+u+s+e}(function(e){var t;if(!i)return e;var n=e.toString().split(c),o=i.split(c);return(t=[]).concat.apply(t,o.map((function(e){return n.map((function(t){return""+e+s+t}))}))).join(c)}(n)),a=d(n,t);m(a)?e(a,{namespace:s,prefix:u},o,r):o[r]=a})),o});var m,p=n(81393),f=n(75952);const h=function(e){return e.toString()};function y(e,t,n){void 0===n&&(n={}),r()(a(e)||s(e),"Expected handlers to be a plain object.");var i=u(e,n),m=l(i).map((function(e){return function(e,t,n){void 0===t&&(t=f.Z);var o=h(e).split(c);r()(!(void 0===n),"defaultState for reducer handling "+o.join(", ")+" should be defined"),r()((0,p.Z)(t)||a(t),"Expected reducer to be a function or object with next and throw reducers");var i=(0,p.Z)(t)?[t,t]:[t.next,t.throw].map((function(e){return null==e?f.Z:e})),s=i[0],l=i[1];return function(e,t){void 0===e&&(e=n);var i=t.type;return i&&-1!==o.indexOf(h(i))?(!0===t.error?l:s)(e,t):e}}(e,d(e,i),t)})),y=o.apply(void 0,m.concat([t]));return function(e,n){return void 0===e&&(e=t),y(e,n)}}var g=n(18172);const b=(e,t)=>y(Object.keys(e).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:(t,o)=>(0,g.ZP)(t,(t=>e[n](t,o)))})),{}),t)},21627:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(47677),i=n.n(o),r=n(81393),a=n(75952);const s=function(e){return null===e};function l(e,t,n){void 0===t&&(t=a.Z),i()((0,r.Z)(t)||s(t),"Expected payloadCreator to be a function, undefined or null");var o=s(t)||t===a.Z?a.Z:function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return e instanceof Error?e:t.apply(void 0,[e].concat(o))},l=(0,r.Z)(n),c=e.toString(),d=function(){var t=o.apply(void 0,arguments),i={type:e};return t instanceof Error&&(i.error=!0),void 0!==t&&(i.payload=t),l&&(i.meta=n.apply(void 0,arguments)),i};return d.toString=function(){return c},d}},75952:(e,t,n)=>{n.d(t,{Z:()=>o});const o=function(e){return e}},81393:(e,t,n)=>{n.d(t,{Z:()=>o});const o=function(e){return"function"==typeof e}}}]);